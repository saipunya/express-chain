<%- include('./partials/header') %>

<form action="/finance/upload" method="POST" enctype="multipart/form-data">
    <div class="mb-3">
        <label for="c_code" class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</label>
        <select name="c_code" id="c_code" class="form-select" required>
          <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå --</option>
          <% coops.forEach(coop => { %>
            <option value="<%= coop.c_code %>"><%= coop.c_name %></option>
          <% }); %>
        </select>
    </div>
    <input type="hidden" name="c_name" id="c_name">
    <script>
    const cCodeSelect = document.getElementById('c_code');
    const cNameInput = document.getElementById('c_name');

    cCodeSelect.addEventListener('change', function () {
        const selectedOption = this.options[this.selectedIndex];
        cNameInput.value = selectedOption.text;
    });
    </script>
    <div class="mb-3">
      <label>‡∏õ‡∏µ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (end_year)</label>
      <input type="text" name="end_year" class="form-control" required>
    </div>
    <div class="mb-3">
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF</label>
      <input type="file" name="file" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-success">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</button>
  </form>
  <hr>
  <h5 class="mt-5">üìÇ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h5>
<table class="table table-bordered">
  <thead>
    <tr>
      <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</th>
      <th>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</th>
      <th>‡πÑ‡∏ü‡∏•‡πå</th>
      <th>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏î‡∏¢</th>
      <th>‡πÄ‡∏°‡∏∑‡πà‡∏≠</th>
    </tr>
  </thead>
  <tbody>
    <% recentUploads.forEach(file => { %>
      <tr>
        <td><%= file.c_name %></td>
        <td><%= file.end_year %></td>
        <td>
          <a href="/download/<%= file.id %>" target="_blank" class="btn btn-sm btn-outline-primary">
            üîó ‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå
          </a>
        </td>
        <td><%= file.saveby %></td>
        <td><%= new Date(file.savedate).toLocaleString('th-TH') %></td>
      </tr>
    <% }) %>
  </tbody>
</table>
<div class="mt-4 text-end">
    <a href="/finance" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô 
    </a>
</div>
<%- include('./partials/footer') %>
