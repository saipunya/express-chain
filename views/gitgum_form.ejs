<%- include('partials/header') %>

<div class="container mt-4">
  <h3 class="mb-4">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>

  <form action="/gitgum/add" method="POST" class="row g-3">
    <div class="col-md-4">
      <label for="git_date" class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
      <input type="date" class="form-control" id="git_date" name="git_date" required />
    </div>

    <div class="col-md-4">
      <label for="git_time" class="form-label">‡πÄ‡∏ß‡∏•‡∏≤</label>
      <input type="time" class="form-control" id="git_time" name="git_time" required />
    </div>

    <div class="col-md-12">
      <label for="git_act" class="form-label">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
      <input type="text" class="form-control" id="git_act" name="git_act" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô..." required />
    </div>

    <div class="col-md-6">
      <label for="git_place" class="form-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</label>
      <input type="text" class="form-control" id="git_place" name="git_place" placeholder="‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°" />
    </div>

    <div class="col-md-6">
      <label for="git_goto" class="form-label">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö/‡∏ú‡∏π‡πâ‡πÑ‡∏õ</label>
      <input type="text" class="form-control" id="git_goto" name="git_goto" placeholder="‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ/‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö" />
    </div>

    <div class="col-md-6">
      <label for="git_respon" class="form-label">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å</label>
      <input type="text" class="form-control" id="git_respon" name="git_respon" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å" />
    </div>

    <div class="col-md-6">
      <label for="git_group" class="form-label">‡∏Å‡∏•‡∏∏‡πà‡∏°/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
      <input type="text" class="form-control" id="git_group" name="git_group" placeholder="‡∏Å‡∏•‡∏∏‡πà‡∏°/‡πÅ‡∏ú‡∏ô‡∏Å" />
    </div>

    <div class="col-md-12">
      <label for="git_maihed" class="form-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
      <textarea class="form-control" id="git_maihed" name="git_maihed" rows="3" placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°/‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"></textarea>
    </div>

    <!-- Hidden meta fields -->
    <input type="hidden" name="git_saveby" value="<%= (user && user.fullname) ? user.fullname : 'guest' %>" />
    <input type="hidden" name="git_savedate" value="<%= new Date().toISOString().slice(0,19).replace('T',' ') %>" />

    <div class="col-12 d-flex gap-2">
      <button type="submit" class="btn btn-success">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
      <a href="/gitgum/list" class="btn btn-secondary">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</a>
    </div>
  </form>
</div>

<!-- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î -->
<% if (recentData && recentData.length > 0) { %>
<div class="container mt-5">
  <div class="card">
    <div class="card-header bg-info text-white">
      <h5 class="mb-0">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (<%= recentData.length %> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h5>
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
              <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
              <th>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
              <th>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</th>
           
              <% if(user && user.mClass=='kjs'){ %>
              <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
              <% } %>
            </tr>
          </thead>
          <tbody>
            <% recentData.forEach(item => { %>
              <tr>
                <% const date = new Date(item.git_date); %>
                <% const options = { year: 'numeric', month: 'short', day: 'numeric' }; %>
                <% const thaiDate = date.toLocaleDateString('th-TH', options); %>
                <td><%= thaiDate %></td>
                <td><%= item.git_time %></td>
                <td>
                  <div class="fw-semibold"><%= item.git_act %></div>
                  <% if (item.git_maihed) { %>
                    <small class="text-muted"><%= item.git_maihed %></small>
                  <% } %>
                </td>
                <td><%= item.git_place || '-' %></td>
                <td><%= item.git_goto || item.git_respon || '-' %></td>
                <td>
                  <small class="text-muted">
                    <%= item.git_saveby %>
                    <br><%= new Date(item.git_savedate).toLocaleString('th-TH', { hour: '2-digit', minute: '2-digit' }) %>
                  </small>
                </td>
                <% if(user && (user.mClass=='kjs' || user.mClass=='admin')){ %>
                <td class="text-center text-nowrap">
                  <div class="btn-group btn-group-sm" role="group">
                    <a href="/gitgum/view/<%= item.git_id %>" class="btn btn-outline-info" title="‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
                      <i class="bi bi-eye"></i>
                    </a>
                    <a href="/gitgum/edit/<%= item.git_id %>" class="btn btn-outline-warning" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">
                      <i class="bi bi-pencil"></i>
                    </a>
                    <a href="/gitgum/delete/<%= item.git_id %>" class="btn btn-outline-danger" title="‡∏•‡∏ö" onclick="return confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏µ‡πâ?')">
                      <i class="bi bi-trash"></i>
                    </a>
                  </div>
                </td>
                <% } %>
              </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card-footer">
      <a href="/gitgum/list" class="btn btn-outline-primary btn-sm">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
      <a href="/gitgum/calendar" class="btn btn-outline-info btn-sm">‡∏î‡∏π‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</a>
    </div>
  </div>
</div>
<% } %>

<%- include('partials/footer') %>

