<%- include('../partials/header', { title: (item ? 'แก้ไข' : 'เพิ่ม') + ' Sangket' }) %>
<div class="container my-4">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-xl-9">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-primary text-white py-3 d-flex justify-content-between align-items-center">
          <h5 class="mb-0 d-flex align-items-center gap-2">
            <i class="bi bi-journal-text"></i> <%= item ? 'แก้ไข' : 'เพิ่ม' %> รายการสังเกต
          </h5>
          <a href="/sangket" class="btn btn-sm btn-outline-light">← กลับ</a>
        </div>
        <form method="POST" action="<%= item ? ('/sangket/edit/' + item.sang_id) : '/sangket/create' %>">
          <div class="card-body">
            <% if (error) { %>
              <div class="alert alert-danger py-2 px-3"><%= error %></div>
            <% } %>
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label">กลุ่ม</label>
                <select name="sang_group" class="form-select">
                  <% const gval = item?.sang_group || '';
                     const groups = ['group1','group2','group3','group4','group5']; %>
                  <option value="">-</option>
                  <% groups.forEach(g => { %>
                    <option value="<%= g %>" <%= g===gval ? 'selected' : '' %>><%= g %></option>
                  <% }) %>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">รหัส</label>
                <input type="text" name="sang_code" class="form-control" required value="<%= item?.sang_code || '' %>">
              </div>
              <div class="col-md-6">
                <label class="form-label">ชื่อสถาบัน</label>
                <input type="text" name="sang_name" class="form-control" required value="<%= item?.sang_name || '' %>">
              </div>

              <div class="col-md-3">
                <label class="form-label">วันสิ้นปี</label>
                <input type="date" name="sang_enddate" class="form-control" value="<%= item?.sang_enddate ? new Date(item.sang_enddate).toISOString().split('T')[0] : '' %>">
              </div>
              <div class="col-md-4">
                <label class="form-label">เลขรับหนังสือ</label>
                <input type="text" name="sang_rabbook" class="form-control" value="<%= item?.sang_rabbook || '' %>">
              </div>
              <div class="col-md-3">
                <label class="form-label">วันที่รับ</label>
                <input type="date" name="sang_rabdate" class="form-control" value="<%= item?.sang_rabdate ? new Date(item.sang_rabdate).toISOString().split('T')[0] : '' %>">
              </div>
              <div class="col-md-2">
                <label class="form-label">สถานะ</label>
                <select name="sang_status" class="form-select">
                  <% const st = item?.sang_status || 'no'; %>
                  <option value="no" <%= st==='no'?'selected':'' %>>no</option>
                  <option value="yes" <%= st==='yes'?'selected':'' %>>yes</option>
                </select>
              </div>

              <div class="col-md-4">
                <label class="form-label">ผู้ตรวจบัญชี</label>
                <input type="text" name="sang_accounter" class="form-control" value="<%= item?.sang_accounter || '' %>">
              </div>
              <div class="col-md-4">
                <label class="form-label">ประเภทการตรวจ</label>
                <input type="text" name="sang_check" class="form-control" value="<%= item?.sang_check || '' %>">
              </div>
              <div class="col-md-4">
                <label class="form-label">ประเภทกรณี</label>
                <input type="text" name="sang_type" class="form-control" value="<%= item?.sang_type || '' %>">
              </div>

              <div class="col-md-4">
                <label class="form-label">เลขส่งหนังสือ</label>
                <input type="text" name="sang_sentbook" class="form-control" value="<%= item?.sang_sentbook || '' %>">
              </div>
              <div class="col-md-3">
                <label class="form-label">วันที่ส่ง</label>
                <input type="date" name="sang_sentdate" class="form-control" value="<%= item?.sang_sentdate ? new Date(item.sang_sentdate).toISOString().split('T')[0] : '' %>">
              </div>
              <div class="col-md-2">
                <label class="form-label">หมวด/ประเภท</label>
                <input type="text" name="sang_category" class="form-control" value="<%= item?.sang_category || '' %>">
              </div>
              <div class="col-md-3">
                <label class="form-label">เงินที่เกี่ยวข้อง</label>
                <input type="text" name="sang_money" class="form-control" placeholder="เช่น 0,0,0" value="<%= item?.sang_money || '' %>">
              </div>

              <div class="col-12">
                <label class="form-label">รายละเอียด (ข้อสังเกต)</label>
                <textarea name="sang_detail" class="form-control" rows="4"><%= item?.sang_detail || '' %></textarea>
              </div>
              <div class="col-12">
                <label class="form-label">หมายเหตุ</label>
                <textarea name="sang_maihed" class="form-control" rows="3"><%= item?.sang_maihed || '' %></textarea>
              </div>

              <input type="hidden" name="sang_savedate" value="<%= item?.sang_savedate ? new Date(item.sang_savedate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0] %>">
            </div>
          </div>
          <div class="card-footer bg-light d-flex justify-content-between align-items-center">
            <a href="/sangket" class="btn btn-outline-secondary"><i class="bi bi-arrow-left me-1"></i> ย้อนกลับ</a>
            <button type="submit" class="btn btn-primary"><i class="bi bi-save2 me-1"></i> บันทึก</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<%- include('../partials/footer') %>
