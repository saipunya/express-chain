<%- include('../partials/header') %>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="bi bi-clipboard-check"></i> ระบบความเข้มแข็งสหกรณ์</h4>
                </div>
                <div class="card-body">
                    <form action="/assessment/process" method="POST">
                        <!-- ข้อมูลมาจาก -->
                        <div class="card mb-4">
                            <div class="card-header bg-secondary text-white">
                                <h5>ข้อมูลมาจากของสหกรณ์</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="cooperative_name" class="form-label">ชื่อสหกรณ์</label>
                                        <input type="text" name="cooperative_name" id="cooperative_name" class="form-control" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="cooperative_type" class="form-label">ประเภทสหกรณ์</label>
                                        <select name="cooperative_type" id="cooperative_type" class="form-select" required>
                                            <option value="">ประเภทสหกรณ์</option>
                                            <option value="เกษตร">เกษตร</option>
                                            <option value="คม">คม</option>
                                            <option value="ประมง">ประมง</option>
                                            <option value="ออมย์">ออมย์</option>
                                            <option value="เนี่ยน">เนี่ยน</option>
                                            <option value="ร้านค้า">ร้านค้า</option>
                                            <option value="อื่นๆ">อื่นๆ</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="assessment_date" class="form-label">วันที่ประเมิน</label>
                                        <input type="date" name="assessment_date" id="assessment_date" class="form-control" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="assessed_by" class="form-label">ผู้ประเมิน</label>
                                        <input type="text" name="assessed_by" id="assessed_by" class="form-control" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- หมวด 1: ความสามารถในการให้ -->
                        <div class="card mb-4">
                            <div class="card-header bg-info text-white">
                                <h5>หมวด 1: ความสามารถในการให้ (30 คะแนน)</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">1.1 ส่วนของส่วนร่วมในการสหกรณ์ (ร้อยละ)</label>
                                    <div class="row">
                                        <div class="col-md-5">
                                            <label class="form-label small">จำนวนส่วนร่วม:</label>
                                            <input type="number" step="0.01" name="criterion_1_1_numerator" class="form-control" required>
                                        </div>
                                        <div class="col-md-2 text-center pt-4">
                                            <span class="fs-4">/</span>
                                        </div>
                                        <div class="col-md-5">
                                            <label class="form-label small">จำนวนทั้งหมด:</label>
                                            <input type="number" step="0.01" name="criterion_1_1_denominator" class="form-control" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">1.2 ผลการดำเนินงานในรอบสองชีย้อน</label>
                                    <select name="criterion_1_2" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="กำไรและสรรครบถ้วน">กำไรและสรรครบถ้วน</option>
                                        <option value="กำไรแต่สรรไม่ครบถ้วน">กำไรแต่สรรไม่ครบถ้วน</option>
                                        <option value="ขาด">ขาด</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">1.3 จำนวนประเภทธุรกิจสหกรณ์งาน</label>
                                    <input type="number" name="criterion_1_3" class="form-control" min="0" max="10" required>
                                </div>
                            </div>
                        </div>

                        <!-- หมวด 2: ผลการดำเนินงาน -->
                        <div class="card mb-4">
                            <div class="card-header bg-success text-white">
                                <h5>หมวด 2: ผลการดำเนินงาน (20 คะแนน)</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">2.1 ส่วนต่อเชื้อรวม</label>
                                    <div class="row">
                                        <div class="col-md-5">
                                            <label class="form-label small">รวม:</label>
                                            <input type="number" step="0.01" name="criterion_2_1_numerator" class="form-control" required>
                                        </div>
                                        <div class="col-md-2 text-center pt-4">
                                            <span class="fs-4">/</span>
                                        </div>
                                        <div class="col-md-5">
                                            <label class="form-label small">รวม:</label>
                                            <input type="number" step="0.01" name="criterion_2_1_denominator" class="form-control" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">2.2 ผลตอบแทนจากออมย์ (ร้อยละ)</label>
                                    <div class="row">
                                        <div class="col-md-5">
                                            <label class="form-label small">กำไรทั้งหมด:</label>
                                            <input type="number" step="0.01" name="criterion_2_2_numerator" class="form-control" required>
                                        </div>
                                        <div class="col-md-2 text-center pt-4">
                                            <span class="fs-4">/</span>
                                        </div>
                                        <div class="col-md-5">
                                            <label class="form-label small">ออมย์เฉลี่ย:</label>
                                            <input type="number" step="0.01" name="criterion_2_2_denominator" class="form-control" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">2.3 ผลตอบแทนจาก (ร้อยละ)</label>
                                    <div class="row">
                                        <div class="col-md-5">
                                            <label class="form-label small">กำไรทั้งหมด:</label>
                                            <input type="number" step="0.01" name="criterion_2_3_numerator" class="form-control" required>
                                        </div>
                                        <div class="col-md-2 text-center pt-4">
                                            <span class="fs-4">/</span>
                                        </div>
                                        <div class="col-md-5">
                                            <label class="form-label small">เฉลี่ย:</label>
                                            <input type="number" step="0.01" name="criterion_2_3_denominator" class="form-control" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">2.4 ค่าใช้จ่ายงานต่อกำไรก่อนหักค่าใช้จ่ายงาน (ร้อยละ)</label>
                                    <div class="row">
                                        <div class="col-md-5">
                                            <label class="form-label small">ค่าใช้จ่ายงาน:</label>
                                            <input type="number" step="0.01" name="criterion_2_4_numerator" class="form-control" required>
                                        </div>
                                        <div class="col-md-2 text-center pt-4">
                                            <span class="fs-4">/</span>
                                        </div>
                                        <div class="col-md-5">
                                            <label class="form-label small">กำไรก่อนหักค่าใช้จ่ายงาน:</label>
                                            <input type="number" step="0.01" name="criterion_2_4_denominator" class="form-control" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">2.5 ส่วนเชื้อต่อฝาก (เท่า)</label>
                                    <div class="row">
                                        <div class="col-md-5">
                                            <label class="form-label small">เชื้อรวม:</label>
                                            <input type="number" step="0.01" name="criterion_2_5_numerator" class="form-control" required>
                                        </div>
                                        <div class="col-md-2 text-center pt-4">
                                            <span class="fs-4">/</span>
                                        </div>
                                        <div class="col-md-5">
                                            <label class="form-label small">ฝากรวม:</label>
                                            <input type="number" step="0.01" name="criterion_2_5_denominator" class="form-control" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">2.6 ระยะเวลาชำระได้ตามกำหนด (ร้อยละ)</label>
                                    <div class="mb-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="criterion_2_6_method" id="calculate" value="calculate" checked>
                                            <label class="form-check-label" for="calculate">คำนวณจากข้อมูล</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="criterion_2_6_method" id="direct" value="direct">
                                            <label class="form-check-label" for="direct">ระดับร้อยละโดยตรง</label>
                                        </div>
                                    </div>
                                    
                                    <div id="calculate_inputs">
                                        <div class="row">
                                            <div class="col-md-5">
                                                <label class="form-label small">ชำระได้:</label>
                                                <input type="number" step="0.01" name="criterion_2_6_numerator" class="form-control">
                                            </div>
                                            <div class="col-md-2 text-center pt-4">
                                                <span class="fs-4">/</span>
                                            </div>
                                            <div class="col-md-5">
                                                <label class="form-label small">ระยะเวลาหมด:</label>
                                                <input type="number" step="0.01" name="criterion_2_6_denominator" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div id="direct_input" style="display: none;">
                                        <label class="form-label small">ค่าร้อยละ:</label>
                                        <input type="number" step="0.01" name="criterion_2_6_direct_percentage" class="form-control" min="0" max="100">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- หมวด 3: ผลการดำเนินงานขององค์กร -->
                        <div class="card mb-4">
                            <div class="card-header bg-warning text-white">
                                <h5>หมวด 3: ผลการดำเนินงานขององค์กร (20 คะแนน)</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">3.1 การทำแผนงาน/โครงการ</label>
                                    <select name="criterion_3_1" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="แผนงานครบถ้วน">แผนงานครบถ้วน</option>
                                        <option value="แผนงานบางส่วน">แผนงานบางส่วน</option>
                                        <option value="ไม่ทำแผนงาน">ไม่ทำแผนงาน</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">3.2 การทำและผล</label>
                                    <select name="criterion_3_2" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="สม่ำเสมอ">สม่ำเสมอ</option>
                                        <option value="บางครั้ง">บางครั้ง</option>
                                        <option value="ไม่ทำ">ไม่ทำ</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">3.3 การจัดการคลากร</label>
                                    <select name="criterion_3_3" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="สม่ำเสมอ">สม่ำเสมอ</option>
                                        <option value="บางครั้ง">บางครั้ง</option>
                                        <option value="ไม่ทำ">ไม่ทำ</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">3.4 การใช้ยากร</label>
                                    <select name="criterion_3_4" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="ใช้ครบถ้วน">ใช้ครบถ้วน</option>
                                        <option value="ใช้ปานกลาง">ใช้ปานกลาง</option>
                                        <option value="ไม่ใช้">ไม่ใช้</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- หมวด 4: ผลการดำเนินงาน -->
                        <div class="card mb-4">
                            <div class="card-header bg-danger text-white">
                                <h5>หมวด 4: ผลการดำเนินงาน (30 คะแนน)</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">4.1 ผลการดำเนินงานของสหกรณ์ต้องไม่ฝ่าฝืนระเบียบ</label>
                                    <select name="criterion_4_1" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="ไม่ฝ่าฝืน">ไม่ฝ่าฝืน</option>
                                        <option value="ฝ่าฝืนเล็กน้อย">ฝ่าฝืนเล็กน้อย</option>
                                        <option value="ฝ่าฝืนมาก">ฝ่าฝืนมาก</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">4.2 ผลการดำเนินงานในรอบสองชีย้อน</label>
                                    <select name="criterion_4_2" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="ไม่ขาด">ไม่ขาด</option>
                                        <option value="ขาดเล็กน้อย">ขาดเล็กน้อย</option>
                                        <option value="ขาดมาก">ขาดมาก</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">4.3 สหกรณ์ทำงบแล้วเสร็จ</label>
                                    <select name="criterion_4_3" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="ทำครบถ้วนตรงเวลา">ทำครบถ้วนตรงเวลา</option>
                                        <option value="ทำครบถ้วนแต่ล่าช้า">ทำครบถ้วนแต่ล่าช้า</option>
                                        <option value="ไม่ทำ">ไม่ทำ</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">4.4 สหกรณ์จ้างเจ้าหน้าที่งานประจำ</label>
                                    <select name="criterion_4_4" class="form-select" required>
                                        <option value="">เลือก</option>
                                        <option value="เจ้าหน้าที่พอ">เจ้าหน้าที่พอ</option>
                                        <option value="เจ้าหน้าที่บางส่วน">เจ้าหน้าที่บางส่วน</option>
                                        <option value="ไม่ใช่เจ้าหน้าที่">ไม่ใช่เจ้าหน้าที่</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="text-center">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-calculator"></i> ผล
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// ตั้งค่าวันที่เป็นวันปัจจุบัน
document.getElementById('assessment_date').value = new Date().toISOString().split('T')[0];

// แสดง/ซ่อน input criterion 2.6
document.querySelectorAll('input[name="criterion_2_6_method"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const calculateInputs = document.getElementById('calculate_inputs');
        const directInput = document.getElementById('direct_input');
        
        if (this.value === 'calculate') {
            calculateInputs.style.display = 'block';
            directInput.style.display = 'none';
            // ทำให้ input ใน calculate_inputs เป็น required
            calculateInputs.querySelectorAll('input').forEach(input => input.required = true);
            directInput.querySelectorAll('input').forEach(input => input.required = false);
        } else {
            calculateInputs.style.display = 'none';
            directInput.style.display = 'block';
            // ทำให้ input ใน direct_input เป็น required
            directInput.querySelectorAll('input').forEach(input => input.required = true);
            calculateInputs.querySelectorAll('input').forEach(input => input.required = false);
        }
    });
});
</script>

<%- include('../partials/footer') %>

