<%- include('../../partials/header.ejs') %>
<div class="container my-4">
  <div class="row justify-content-center">
    <div class="col-lg-9 col-xl-8">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-dark text-white py-3 d-flex justify-content-between align-items-center">
          <h5 class="mb-0 d-flex align-items-center gap-2">
            <span class="fs-5">üß©</span> ‡πÄ‡∏û‡∏¥‡πà‡∏° Chamra Process
          </h5>
          <a href="/chamra/process" class="btn btn-sm btn-outline-light">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</a>
        </div>
        <form method="POST" action="/chamra/process/add" novalidate>
          <div class="card-body">
            <% if (error) { %>
              <div class="alert alert-danger py-2 px-3"><%= error %></div>
            <% } %>
            <div class="mb-3">
              <label class="form-label fw-semibold">‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô (‡∏£‡∏´‡∏±‡∏™) <span class="text-danger">*</span></label>
              <select name="pr_code" class="form-select form-select-sm" required>
                <option value="" disabled <%= !old.pr_code ? 'selected' : '' %>>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <% coopList.forEach(c => { %>
                  <option value="<%= c.c_code %>" <%= old.pr_code === c.c_code ? 'selected' : '' %>><%= c.c_code %> - <%= c.c_name %></option>
                <% }) %>
              </select>
            </div>

            <div class="border rounded p-3 mb-3">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <strong class="small text-uppercase text-secondary">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á)</strong>
                <button type="button" class="btn btn-xs btn-outline-secondary btn-sm" onclick="fillToday()">‡πÄ‡∏ï‡∏¥‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á</button>
              </div>
              <div class="row g-2">
                <% for (let i=1;i<=10;i++){ const k='pr_s'+i; %>
                  <div class="col-6 col-md-4 col-lg-3">
                    <label class="form-label small mb-1">S<%= i %></label>
                    <input type="date" name="pr_s<%= i %>" class="form-control form-control-sm" value="<%= old[k] || '' %>">
                  </div>
                <% } %>
              </div>
              <div class="form-text mt-2">‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô 0000-00-00</div>
            </div>

            <div class="d-flex gap-2 flex-wrap">
              <button type="submit" class="btn btn-primary btn-sm d-flex align-items-center gap-2">
                ‚úÖ <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
              </button>
              <a href="/chamra/process" class="btn btn-outline-secondary btn-sm">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</a>
            </div>
          </div>
        </form>
      </div>
      <div class="text-center small text-muted mt-3">Chamra Process Management</div>
    </div>
  </div>
</div>
<script>
function fillToday(){
  const today = new Date();
  const y = today.getFullYear();
  const m = String(today.getMonth()+1).padStart(2,'0');
  const d = String(today.getDate()).padStart(2,'0');
  document.querySelectorAll('input[type="date"]').forEach(el=>{
    if(!el.value) el.value = `${y}-${m}-${d}`;
  });
}
</script>
<%- include('../../partials/footer.ejs') %>
