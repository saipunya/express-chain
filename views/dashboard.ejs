<%- include('partials/header.ejs') %>

  <!-- Modern Dashboard -->
  <div class="container-fluid py-4 dashboard-wrapper">
    <div class="container">
      <!-- Welcome / Profile Section -->
      <div class="row g-4 align-items-stretch mb-4">
        <div class="col-lg-8">
          <div class="card border-0 shadow-lg glass-card h-100">
            <div class="card-body p-4 p-lg-5 d-flex flex-column justify-content-center">
              <h1 class="display-6 fw-bold text-gradient mb-3">
                <i class="bi bi-speedometer2 me-2"></i> แดชบอร์ด
              </h1>
              <p class="text-muted mb-4">ศูนย์รวมเมนูการทำงานและข้อมูลล่าสุด เพื่อการเข้าถึงฟีเจอร์อย่างรวดเร็ว</p>

              <!-- Quick Action Buttons (Role Based) -->
              <div class="d-flex flex-wrap gap-2">
                <% if (user && user.mClass === 'kjs') { %>
                  <a href="/chamra/" class="btn btn-outline-danger btn-action"><i class="bi bi-info-circle me-1"></i> ชำระบัญชี</a>
                <% } %>
                <% if (user && user.mClass === 'admin') { %>
                  <a href="/member" class="btn btn-warning text-dark btn-action"><i class="bi bi-people me-1"></i> จัดการสมาชิก</a>
                  <!-- add strength menu -->
                  <a href="/strength" class="btn btn-outline-primary btn-action"><i class="bi bi-shield-lock me-1"></i> จัดการความเข้มแข็ง</a>
                  <!-- จัดการ suggestion menu -->
                  <a href="/suggestion" class="btn btn-outline-info btn-action"><i class="bi bi-lightbulb me-1"></i> คำแนะนำนายทะเบียนสหกรณ์</a>
                  <!-- ผลประชุมใหญ่ -->
                  <a href="/bigmeet" class="btn btn-outline-success btn-action"><i class="bi bi-calendar-check me-1"></i> ผลประชุมใหญ่</a>
                  <!-- จำนวนสมาชิก -->
                  <a href="/addmem/list" class="btn btn-outline-secondary btn-action"><i class="bi bi-person-plus me-1"></i> จำนวนสมาชิก</a>
                <% } %>
                <a href="/gitgum/add" class="btn btn-outline-secondary btn-action"><i class="bi bi-plus-circle me-1"></i> เพิ่มกิจกรรมสำนักงาน</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Profile Card -->
        <div class="col-lg-4">
          <div class="card border-0 shadow-lg profile-card h-100 position-relative overflow-hidden">
            <div class="card-body text-center p-4 d-flex flex-column justify-content-center">
              <div class="position-relative d-inline-block mb-3">
                <img src="<%= user.m_img %>" alt="Profile" class="rounded-circle shadow profile-avatar avatar-lg">
                <span class="status-badge bg-success" title="online"></span>
              </div>
              <h4 class="fw-bold mb-1 text-dark"><i class="bi bi-person-badge me-1 text-primary"></i><%= user.fullname %></h4>
              <p class="text-muted mb-3"><i class="bi bi-award me-1"></i> <%= user.position %></p>
              <!-- for admin link only -->
              <% if (user && user.mClass === 'admin') { %>
                <a href="/auditlog" class="btn btn-primary btn-action mb-2"><i class="bi bi-speedometer2 me-1"></i> auditlog</a>
              <% } %>
              <a href="/auth/logout" class="btn btn-outline-danger w-100"><i class="bi bi-box-arrow-right me-1"></i> ออกจากระบบ</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Metrics Overview (Optional placeholders) -->
      <div class="row g-3 mb-4 metrics-row">
        <div class="col-6 col-md-3">
          <div class="mini-stat shadow-sm">
            <div class="icon bg-gradient-primary-soft"><i class="bi bi-file-earmark-text"></i></div>
            <div class="text">
              <div class="value"><%= (typeof projectCount !== 'undefined' ? projectCount : 0) %></div>
              <div class="label">โครงการ</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="mini-stat shadow-sm">
            <div class="icon bg-gradient-success-soft"><i class="bi bi-book"></i></div>
            <div class="text">
              <div class="value"><%= (typeof commandCount !== 'undefined' ? commandCount : 0) %></div>
              <div class="label">คำสั่ง</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="mini-stat shadow-sm">
            <div class="icon bg-gradient-info-soft"><i class="bi bi-graph-up"></i></div>
            <div class="text">
              <div class="value"><%= (activity && activity.length) || 0 %></div>
              <div class="label">กิจกรรม</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="mini-stat shadow-sm">
            <div class="icon bg-gradient-warning-soft"><i class="bi bi-people"></i></div>
            <div class="text">
              <div class="value"><%= (typeof memberCount !== 'undefined' ? memberCount : '-') %></div>
              <div class="label">สมาชิก</div>
            </div>
          </div>
        </div>
      </div>
    

     
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-header bg-white border-0 py-3 d-flex align-items-center justify-content-between">
          <h4 class="mb-0"><i class="bi bi-grid-3x3-gap me-2 text-primary"></i>เมนูใช้งาน</h4>
          <span class="text-muted small">เลือกเมนูเพื่อเข้าถึงงานที่ต้องการ</span>
        </div>
        <div class="card-body p-4">
          <div class="menu-section-title">ข้อมูลและรายงาน</div>
          <div class="row g-3 mb-4">
            <div class="col-md-4">
              <a href="/allCoop" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-building"></i></div>
                  <div>
                    <p class="menu-title">ข้อมูลสถาบัน</p>
                    <p class="menu-desc">สหกรณ์และกลุ่มเกษตรกร</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/strength/list" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-shield-lock"></i></div>
                  <div>
                    <p class="menu-title">ความเข้มแข็ง</p>
                    <p class="menu-desc">ดูตัวชี้วัดความเข้มแข็ง</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/finance" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-file-earmark-bar-graph"></i></div>
                  <div>
                    <p class="menu-title">รายงานงบการเงิน</p>
                    <p class="menu-desc">สหกรณ์/กลุ่มเกษตรกร</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/business" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-briefcase"></i></div>
                  <div>
                    <p class="menu-title">รายงานกิจการ</p>
                    <p class="menu-desc">สหกรณ์/กลุ่มเกษตรกร</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/rule" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-journal-text"></i></div>
                  <div>
                    <p class="menu-title">ข้อบังคับ</p>
                    <p class="menu-desc">สหกรณ์/กลุ่มเกษตรกร</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/rabiab" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-file-earmark-ruled"></i></div>
                  <div>
                    <p class="menu-title">ระเบียบ</p>
                    <p class="menu-desc">สหกรณ์/กลุ่มเกษตรกร</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/vong" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-cash-coin"></i></div>
                  <div>
                    <p class="menu-title">วงกู้ยืม/ค้ำประกัน</p>
                    <p class="menu-desc">สหกรณ์/กลุ่มเกษตรกร</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/bigmeet" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-calendar-check"></i></div>
                  <div>
                    <p class="menu-title">ผลประชุมใหญ่</p>
                    <p class="menu-desc">ดูรายการประชุมใหญ่</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/addmem/list" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-person-plus"></i></div>
                  <div>
                    <p class="menu-title">จำนวนสมาชิก</p>
                    <p class="menu-desc">ข้อมูลสมาชิกสหกรณ์</p>
                  </div>
                </div>
              </a>
            </div>
          </div>

          <div class="menu-section-title">โครงการและกิจกรรม</div>
          <div class="row g-3 mb-4">
            <div class="col-md-4">
              <a href="/plan" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-diagram-3"></i></div>
                  <div>
                    <p class="menu-title">แผนงานโครงการ</p>
                    <p class="menu-desc">ติดตามภาพรวมโครงการ</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/project" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-kanban"></i></div>
                  <div>
                    <p class="menu-title">โครงการ</p>
                    <p class="menu-desc">จัดการโครงการและกิจกรรม</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/command" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-megaphone"></i></div>
                  <div>
                    <p class="menu-title">คำสั่งสำนักงาน</p>
                    <p class="menu-desc">ประกาศและคำสั่งล่าสุด</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/rq2" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-graph-up"></i></div>
                  <div>
                    <p class="menu-title">รายงาน RQ2</p>
                    <p class="menu-desc">สำนักงานตรวจบัญชี</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/usecar" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-car-front"></i></div>
                  <div>
                    <p class="menu-title">การขอใช้รถยนต์</p>
                    <p class="menu-desc">ข้อมูลและรายงาน</p>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/down" class="menu-link">
                <div class="menu-card">
                  <div class="menu-icon"><i class="bi bi-download"></i></div>
                  <div>
                    <p class="menu-title">ดาวน์โหลด</p>
                    <p class="menu-desc">เอกสารและไฟล์ต่างๆ</p>
                  </div>
                </div>
              </a>
            </div>
            <% if (user && user.mClass === 'kjs') { %>
              <div class="col-md-4">
                <a href="/chamra/" class="menu-link">
                  <div class="menu-card">
                    <div class="menu-icon"><i class="bi bi-activity"></i></div>
                    <div>
                      <p class="menu-title">ชำระบัญชี</p>
                      <p class="menu-desc">ติดตามสถานะชำระบัญชี</p>
                    </div>
                  </div>
                </a>
              </div>
            <% } %>
          </div>

          <% if (user && user.mClass === 'admin') { %>
            <div class="menu-section-title">สำหรับผู้ดูแลระบบ</div>
            <div class="row g-3">
              <div class="col-md-4">
                <a href="/member" class="menu-link">
                  <div class="menu-card">
                    <div class="menu-icon"><i class="bi bi-people"></i></div>
                    <div>
                      <p class="menu-title">จัดการสมาชิก</p>
                      <p class="menu-desc">บัญชีและสิทธิ์ผู้ใช้งาน</p>
                    </div>
                  </div>
                </a>
              </div>
              <div class="col-md-4">
                <a href="/strength" class="menu-link">
                  <div class="menu-card">
                    <div class="menu-icon"><i class="bi bi-shield-lock"></i></div>
                    <div>
                      <p class="menu-title">จัดการความเข้มแข็ง</p>
                      <p class="menu-desc">ตัวชี้วัดและการประเมิน</p>
                    </div>
                  </div>
                </a>
              </div>
              <div class="col-md-4">
                <a href="/suggestion" class="menu-link">
                  <div class="menu-card">
                    <div class="menu-icon"><i class="bi bi-lightbulb"></i></div>
                    <div>
                      <p class="menu-title">คำแนะนำ</p>
                      <p class="menu-desc">นายทะเบียนสหกรณ์</p>
                    </div>
                  </div>
                </a>
              </div>
              <div class="col-md-4">
                <a href="/activeCoop/" class="menu-link">
                  <div class="menu-card">
                    <div class="menu-icon"><i class="bi bi-gear"></i></div>
                    <div>
                      <p class="menu-title">ตั้งค่า</p>
                      <p class="menu-desc">ระบบและข้อมูลอ้างอิง</p>
                    </div>
                  </div>
                </a>
              </div>
              <div class="col-md-4">
                <a href="/auditlog" class="menu-link">
                  <div class="menu-card">
                    <div class="menu-icon"><i class="bi bi-clipboard-check"></i></div>
                    <div>
                      <p class="menu-title">Audit Log</p>
                      <p class="menu-desc">บันทึกการใช้งานระบบ</p>
                    </div>
                  </div>
                </a>
              </div>
           
            </div>
          <% } %>
        </div>
      </div>

     

    </div>
  </div>

  <!-- Styles -->
  <style>
    .dashboard-wrapper {background: linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%); min-height:100vh;}
    .glass-card {background: rgba(255,255,255,0.9); backdrop-filter: blur(6px); border-radius: 20px;}
    .profile-card {background: linear-gradient(135deg,#ffffff 0%, #f0f4ff 100%); border-radius: 20px;}
    .text-gradient {background: linear-gradient(90deg,#0d6efd,#6610f2); -webkit-background-clip: text; background-clip: text; color: transparent;}
    .profile-avatar {width:100px; height:100px; object-fit:cover; border:4px solid #fff;}
    .status-badge {position:absolute; bottom:6px; right:6px; width:16px; height:16px; border-radius:50%; border:2px solid #fff;}
    .btn-action {font-size:.85rem;}

    /* Metrics */
    .mini-stat {display:flex; align-items:center; gap:12px; background:#fff; border-radius:14px; padding:14px 16px; position:relative; overflow:hidden; transition:.25s;}
    .mini-stat:hover {box-shadow:0 8px 24px rgba(0,0,0,.07); transform:translateY(-4px);}
    .mini-stat .icon {width:46px; height:46px; display:flex; align-items:center; justify-content:center; font-size:1.25rem; border-radius:12px;}
    .mini-stat .value {font-size:1.25rem; font-weight:600; line-height:1;}
    .mini-stat .label {font-size:.75rem; text-transform:uppercase; letter-spacing:.5px; color:#6c757d;}
    .bg-gradient-primary-soft {background:linear-gradient(135deg,#dbeafe,#bfdbfe);} 
    .bg-gradient-success-soft {background:linear-gradient(135deg,#dcfce7,#bbf7d0);} 
    .bg-gradient-info-soft {background:linear-gradient(135deg,#e0f2fe,#bae6fd);} 
    .bg-gradient-warning-soft {background:linear-gradient(135deg,#fef9c3,#fde68a);} 

    /* Feature Cards */
    .menu-link {text-decoration:none;}
    .menu-card {
      display:flex;
      align-items:center;
      gap:12px;
      padding:14px 16px;
      background:#fff;
      border:1px solid #dee2e6;
      border-radius:10px;
      transition:.15s ease;
      height:100%;
    }
    .menu-card:hover {background:#f8f9fa;}
    .menu-icon {
      width:44px;
      height:44px;
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#e9ecef;
      color:#0d6efd;
      font-size:1.25rem;
      flex-shrink:0;
    }
    .menu-title {margin:0; font-weight:600; color:#212529;}
    .menu-desc {margin:0; font-size:.85rem; color:#6c757d;}
    .menu-section-title {
      font-size:.8rem;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#6c757d;
      margin-bottom:.5rem;
    }

    /* Activities */
    .activity-item {font-size:.9rem; transition:.25s;}
    .activity-item:hover {background:rgba(0,0,0,.02);} 

    /* Scroll enhancements */
    ::-webkit-scrollbar {width:10px;} 
    ::-webkit-scrollbar-track {background:#eef1f5;} 
    ::-webkit-scrollbar-thumb {background:#c2cbd6; border-radius:6px;} 
    ::-webkit-scrollbar-thumb:hover {background:#a8b3c2;} 

    @media (max-width: 575.98px){
      .feature-card {padding:26px 16px;}
      .mini-stat {padding:12px 14px;}
      .profile-avatar {width:72px; height:72px;}
    }
  </style>

  <%- include('partials/footer') %>