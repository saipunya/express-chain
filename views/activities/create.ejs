<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>เพิ่มกิจกรรมใหม่</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <h1 class="mb-4">เพิ่มกิจกรรมใหม่</h1>
    <form action="/activities/create" method="POST">
      <div class="mb-3">
        <label class="form-label">วันที่:</label>
        <input type="date" name="date_act" class="form-control" required>
      </div>
      <div class="mb-3">
        <label class="form-label">เวลา:</label>
        <input type="time" name="act_time" id="act_time" class="form-control" required>
        <small id="thai-time" class="form-text text-muted"></small>
      </div>
      <div class="mb-3">
        <label class="form-label">กิจกรรม:</label>
        <textarea name="activity" class="form-control" required></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">สถานที่:</label>
        <input type="text" name="place" class="form-control" required>
      </div>
      <div class="mb-3">
        <label class="form-label">ผู้รับผิดชอบ:</label>
        <input type="text" name="co_person" class="form-control" required>
      </div>
      <div class="mb-3">
        <label class="form-label">ความคิดเห็น:</label>
        <textarea name="comment" class="form-control"></textarea>
      </div>
      <input type="hidden" name="saveby" id="saveby" value="<%= user.m_name %>">
      <input type="hidden" name="savedate" id="savedate">
      <button type="submit" class="btn btn-success">บันทึก</button>
      <a href="/activities" class="btn btn-secondary">ยกเลิก</a>
    </form>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const actTimeInput = document.getElementById('act_time');
      const thaiTimeElement = document.getElementById('thai-time');
      const saveByInput = document.getElementById('saveby');
      const saveDateInput = document.getElementById('savedate');

      const updateThaiTime = () => {
        const now = new Date();
        const thaiTime = now.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });
        thaiTimeElement.textContent = `เวลาปัจจุบัน: ${thaiTime}`;
        
        // Prefill the time input with the current time in 24-hour format
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        actTimeInput.value = `${hours}:${minutes}`;

        // Prefill the hidden savedate input with the current date
        const currentDate = now.toISOString().split('T')[0];
        saveDateInput.value = currentDate;
      };

      updateThaiTime();
      setInterval(updateThaiTime, 1000); // Update every second
    });
  </script>
</body>
</html>
