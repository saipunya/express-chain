<div class="row g-3">
  <% (articles || []).forEach((article, idx) => { %>
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm border-0 article-card">
        <div class="gradient-bar"></div>

        <div class="position-relative">
          <div class="ratio ratio-16x9">
            <%
              let imgs = [];
              try { imgs = JSON.parse(article.ar_img || '[]'); } catch(e) {}
            %>
            <% if (imgs.length) { %>
              <img src="/uploads/article/<%= imgs[0] %>" alt="img" class="w-100 h-100" style="object-fit:cover;">
            <% } else { %>
              <div class="d-flex align-items-center justify-content-center bg-light w-100 h-100">
                <i class="bi bi-image text-muted fs-1"></i>
              </div>
            <% } %>
          </div>
          <span class="badge bg-primary position-absolute top-0 start-0 m-2">
            <%= new Date(article.ar_savedate).toLocaleDateString('th-TH') %>
          </span>
        </div>

        <div class="card-body d-flex flex-column">
          <h6 class="card-title mb-2 text-truncate" title="<%= article.ar_subject %>">
            <i class="bi bi-journal-text me-1 text-primary"></i><%= article.ar_subject %>
          </h6>
          <p class="card-text text-muted small mb-3 line-clamp-2">
            <%= (article.ar_detail || '').substring(0, 180) %>...
          </p>

          <div class="mt-auto d-flex justify-content-between align-items-center">
            <small class="text-muted">
              <i class="bi bi-person-circle me-1"></i><%= article.ar_saveby %>
            </small>
            <a href="/article/view/<%= article.ar_id %>" class="btn btn-sm btn-primary">
              <i class="bi bi-eye me-1"></i> อ่านต่อ
            </a>
          </div>
        </div>
      </div>
    </div>

    <% if ((idx + 1) % 3 === 0) { %>
      </div><div class="row g-3">
    <% } %>
  <% }) %>
</div>
